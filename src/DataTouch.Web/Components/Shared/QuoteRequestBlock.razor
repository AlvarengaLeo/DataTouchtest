@using MudBlazor
@using DataTouch.Web.Models

@* ═══════════════════════════════════════════════════════════════
   QuoteRequestBlock — Single source of truth for the quote CTA block.
   Used identically in: PublicCard, MyCard (LivePreview), TemplateLibrary.
   All colors come from --dt-* CSS variables (injected by parent context).
   ═══════════════════════════════════════════════════════════════ *@

<div class="qrb @(Compact ? "qrb--compact" : "")" style="@ContainerStyle">
    <h3 class="qrb__title">@Title</h3>
    <p class="qrb__subtitle">@Subtitle</p>
    @if (ShowLegalText && !string.IsNullOrEmpty(LegalText))
    {
        <p class="qrb__legal">@LegalText</p>
    }
    <button type="button" class="qrb__cta" @onclick="OnCtaClick">
        <svg class="qrb__cta-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zm-1 2l5 5h-5V4zm-2.5 9.5a.5.5 0 0 1 0 1H7a.5.5 0 0 1 0-1h3.5zm4 3a.5.5 0 0 1 0 1H7a.5.5 0 0 1 0-1h7.5zm0 3a.5.5 0 0 1 0 1H7a.5.5 0 0 1 0-1h7.5z"/>
        </svg>
        @CtaLabel
    </button>
</div>

@code {
    [Parameter] public string Title { get; set; } = "Solicitar cotización";
    [Parameter] public string Subtitle { get; set; } = "Describe lo que necesitas y te respondo pronto.";
    [Parameter] public string CtaLabel { get; set; } = "Solicitar cotización";
    [Parameter] public bool ShowLegalText { get; set; }
    [Parameter] public string? LegalText { get; set; }
    [Parameter] public bool Compact { get; set; }
    [Parameter] public EventCallback OnCtaClick { get; set; }
    /// <summary>Optional inline style for injecting CSS variables (e.g. in TemplateLibrary).</summary>
    [Parameter] public string? ContainerStyle { get; set; }
}

<style>
    /* ═══════════════════════════════════════════════════════════════
       QUOTE REQUEST BLOCK — Shared component styles
       Colors from --dt-* CSS variables (ThemeHelper); contrast-safe.
       ═══════════════════════════════════════════════════════════════ */

    .qrb {
        margin: 24px 0 20px;
        width: 100%;
        text-align: center;
        padding: 20px 16px;
        background: var(--dt-modal-surface2, rgba(0, 0, 0, 0.025));
        border: 1px solid var(--dt-modal-border, rgba(0, 0, 0, 0.08));
        border-radius: 16px;
        box-sizing: border-box;
    }

    .qrb__title {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--dt-text-primary, rgba(26, 26, 46, 0.95));
        margin: 0 0 6px;
        line-height: 1.3;
    }

    .qrb__subtitle {
        font-size: 0.85rem;
        color: var(--dt-text-muted, rgba(26, 26, 46, 0.5));
        margin: 0 0 16px;
        line-height: 1.4;
    }

    .qrb__legal {
        font-size: 0.75rem;
        color: var(--dt-text-muted, rgba(26, 26, 46, 0.4));
        font-style: italic;
        margin: 0 0 12px;
    }

    .qrb__cta {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        width: 100%;
        padding: 12px 24px;
        border: none;
        border-radius: 12px;
        background: linear-gradient(135deg, #F59E0B, #EF4444);
        color: white;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: filter 0.15s ease, transform 0.15s ease;
        box-shadow: 0 4px 14px rgba(245, 158, 11, 0.25);
        text-transform: none;
        letter-spacing: 0;
        line-height: 1.4;
    }

    .qrb__cta:hover {
        filter: brightness(1.1);
        transform: translateY(-1px);
    }

    .qrb__cta-icon {
        width: 18px;
        height: 18px;
        flex-shrink: 0;
    }

    /* ───────────────────────────────────────────────────────────────
       COMPACT MODE — Phone preview / Template preview sizing
       Same visual hierarchy, proportionally scaled down.
       ─────────────────────────────────────────────────────────────── */

    .qrb--compact {
        margin: 16px 0 12px;
        padding: 14px 12px;
        border-radius: 14px;
    }

    .qrb--compact .qrb__title {
        font-size: 0.8rem;
    }

    .qrb--compact .qrb__subtitle {
        font-size: 0.6rem;
        margin: 0 0 12px;
    }

    .qrb--compact .qrb__legal {
        font-size: 0.55rem;
        margin: 0 0 10px;
    }

    .qrb--compact .qrb__cta {
        padding: 9px 16px;
        border-radius: 10px;
        font-size: 0.7rem;
        font-weight: 700;
        gap: 6px;
    }

    .qrb--compact .qrb__cta-icon {
        width: 14px;
        height: 14px;
    }
</style>
